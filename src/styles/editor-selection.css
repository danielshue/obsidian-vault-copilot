/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Dan Shue. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

/**
 * Editor Selection Preservation
 * 
 * Preserves visual highlighting of text selections in the Obsidian editor
 * even when focus moves to other elements (e.g., chat input).
 * 
 * This improves UX by:
 * - Showing users what text will be included as context
 * - Making implicit context augmentation more transparent
 * - Maintaining visual feedback across focus changes
 */

/* 
 * Preserve selection highlighting in unfocused/inactive editor elements
 * Uses ::selection pseudo-element to style text selection appearance
 * Works across all editor elements in the workspace
 */
.workspace-leaf-content ::selection {
	/* Use a slightly muted version of the selection color for inactive selections */
	background: var(--text-selection);
	color: inherit;
}

/* 
 * CodeMirror-specific selection preservation
 * Obsidian uses CodeMirror for the editor
 */
.cm-editor .cm-selectionBackground,
.cm-editor .cm-content ::selection,
.cm-editor .cm-line ::selection {
	background: var(--text-selection) !important;
}

/*
 * Ensure selection remains visible when editor loses focus
 * Override default behavior that hides selection on blur
 */
.cm-editor.cm-focused .cm-selectionBackground {
	background: var(--text-selection);
}

.cm-editor:not(.cm-focused) .cm-selectionBackground {
	/* Keep selection visible even when not focused */
	background: var(--text-selection);
	opacity: 0.7; /* Slightly more transparent to indicate inactive state */
}

/*
 * Mobile-specific adjustments
 * Ensure selection remains visible on mobile devices
 */
.is-mobile .cm-editor:not(.cm-focused) .cm-selectionBackground {
	opacity: 0.6; /* Slightly more visible on mobile */
}

/*
 * Preserve selection in Legacy editor (for older Obsidian versions)
 * Uses contenteditable-based editor
 */
.markdown-source-view.is-readable-line-width ::selection,
.markdown-source-view ::selection {
	background: var(--text-selection);
}

/*
 * Ensure selection is visible when chat view has focus
 * This is the primary use case for this feature
 */
.vc-chat-container:focus-within ~ .workspace-leaf-content ::selection,
.vc-input:focus ~ .workspace-leaf-content ::selection {
	background: var(--text-selection);
	opacity: 0.7;
}
