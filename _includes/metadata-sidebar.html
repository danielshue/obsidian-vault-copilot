<div class="metadata-sidebar">
  <!-- Close button for mobile -->
  <button class="sidebar-close" aria-label="Close sidebar">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>
  
  <!-- Identifier -->
  {% if page.identifier %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Identifier</h3>
    <p class="sidebar-value"><code>{{ page.identifier }}</code></p>
  </div>
  {% endif %}
  
  <!-- Version -->
  {% if page.version %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Version</h3>
    <p class="sidebar-value">{{ page.version }}</p>
  </div>
  {% endif %}
  
  <!-- Rating (populated via JS from Azure API) -->
  <div class="sidebar-section" id="sidebar-rating" style="display:none;">
    <h3 class="sidebar-heading">Rating</h3>
    <div class="sidebar-rating-display">
      <span id="sidebar-stars" class="sidebar-stars"></span>
      <span id="sidebar-rating-text" class="sidebar-rating-text"></span>
    </div>
  </div>
  
  <!-- Downloads (populated via JS from Azure API) -->
  <div class="sidebar-section" id="sidebar-downloads" style="display:none;">
    <h3 class="sidebar-heading">Downloads</h3>
    <p class="sidebar-value" id="sidebar-downloads-count"></p>
  </div>
  
  <!-- Last Updated -->
  {% if page.last_updated %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Last Updated</h3>
    <p class="sidebar-value">{{ page.last_updated | date: "%B %d, %Y" }}</p>
  </div>
  {% elsif page.date %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Last Updated</h3>
    <p class="sidebar-value">{{ page.date | date: "%B %d, %Y" }}</p>
  </div>
  {% endif %}
  
  <!-- Size -->
  {% if page.size %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Size</h3>
    <p class="sidebar-value">{{ page.size }}</p>
  </div>
  {% endif %}
  
  <!-- Categories -->
  {% if page.categories and page.categories.size > 0 %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Categories</h3>
    <ul class="sidebar-tags">
      {% for category in page.categories %}
      <li class="sidebar-tag">{{ category }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
  
  <!-- Tags -->
  {% if page.tags and page.tags.size > 0 %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Tags</h3>
    <ul class="sidebar-tags">
      {% for tag in page.tags %}
      <li class="sidebar-tag">{{ tag }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
  
  <!-- Tools Used -->
  {% if page.tools and page.tools.size > 0 %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Tools Used</h3>
    <ul class="sidebar-tools">
      {% for tool in page.tools %}
      <li class="sidebar-tool">
        {% if tool.name %}
          <strong>{{ tool.name }}</strong>
          {% if tool.description %}<span class="tool-description">{{ tool.description }}</span>{% endif %}
        {% else %}
          {{ tool }}
        {% endif %}
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
  
  <!-- Resources -->
  <div class="sidebar-section sidebar-resources">
    <h3 class="sidebar-heading">Resources</h3>
    <ul class="sidebar-links">
      {% if page.repository %}
      <li>
        <a href="{{ page.repository }}" target="_blank" rel="noopener noreferrer">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path>
            <path d="M9 18c-4.51 2-5-2-7-2"></path>
          </svg>
          Repository
        </a>
      </li>
      {% endif %}
      
      {% if page.author_url %}
      <li>
        <a href="{{ page.author_url }}" target="_blank" rel="noopener noreferrer">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          {{ page.author | default: "Author" }}
        </a>
      </li>
      {% endif %}
      
      {% if page.documentation %}
      <li>
        <a href="{{ page.documentation }}" target="_blank" rel="noopener noreferrer">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
          </svg>
          Documentation
        </a>
      </li>
      {% endif %}
      
      {% if page.issues %}
      <li>
        <a href="{{ page.issues }}" target="_blank" rel="noopener noreferrer">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          Report Issue
        </a>
      </li>
      {% endif %}
      
      {% if page.license %}
      <li>
        <a href="{{ page.license_url | default: '#' }}" {% if page.license_url %}target="_blank" rel="noopener noreferrer"{% endif %}>
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
          </svg>
          {{ page.license }}
        </a>
      </li>
      {% endif %}
    </ul>
  </div>
  
  <!-- Compatibility -->
  {% if page.compatibility %}
  <div class="sidebar-section">
    <h3 class="sidebar-heading">Compatibility</h3>
    <ul class="sidebar-compatibility">
      {% if page.compatibility.vscode %}
      <li><strong>VS Code:</strong> {{ page.compatibility.vscode }}</li>
      {% endif %}
      {% if page.compatibility.copilot %}
      <li><strong>Copilot:</strong> {{ page.compatibility.copilot }}</li>
      {% endif %}
    </ul>
  </div>
  {% endif %}
</div>
