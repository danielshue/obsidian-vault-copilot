---
layout: default
title: Browse Extensions
---

<div class="catalog-page">
  <div class="catalog-header">
    <h1>Browse Extensions</h1>
    <p class="catalog-description">Discover agents, prompts, skills, and MCP servers for Vault Copilot</p>
  </div>

  <div class="catalog-filters">
    <div class="filter-group">
      <label for="type-filter">Type:</label>
      <select id="type-filter" class="filter-select">
        <option value="">All Types</option>
        <option value="agent">Agents</option>
        <option value="voice-agent">Voice Agents</option>
        <option value="prompt">Prompts</option>
        <option value="skill">Skills</option>
        <option value="mcp-server">MCP Servers</option>
      </select>
    </div>
    <div class="filter-group">
      <label for="category-filter">Category:</label>
      <select id="category-filter" class="filter-select">
        <option value="">All Categories</option>
      </select>
    </div>
    <div class="filter-group">
      <label for="sort-filter">Sort:</label>
      <select id="sort-filter" class="filter-select">
        <option value="name">Name</option>
        <option value="newest">Newest</option>
        <option value="downloads">Most Downloads</option>
        <option value="rating">Highest Rated</option>
      </select>
    </div>
  </div>

  <div class="catalog-stats">
    <span id="extension-count">Loading...</span>
  </div>

  <div class="extensions-grid" id="extensions-grid">
    <div class="loading">Loading extensions...</div>
  </div>
</div>

<style>
.catalog-page {
  max-width: var(--max-width);
  margin: 0 auto;
}

.catalog-header {
  text-align: center;
  margin-bottom: var(--spacing-xl);
}

.catalog-description {
  color: var(--color-text-secondary);
  font-size: 1.1rem;
}

.catalog-filters {
  display: flex;
  gap: var(--spacing-md);
  flex-wrap: wrap;
  margin-bottom: var(--spacing-lg);
  padding: var(--spacing-md);
  background: var(--color-bg-secondary);
  border-radius: var(--border-radius);
}

.filter-group {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.filter-group label {
  font-size: 0.875rem;
  color: var(--color-text-secondary);
}

.filter-select {
  padding: var(--spacing-sm) var(--spacing-md);
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius);
  background: var(--color-bg);
  color: var(--color-text);
  font-size: 0.875rem;
}

.catalog-stats {
  margin-bottom: var(--spacing-md);
  font-size: 0.875rem;
  color: var(--color-text-secondary);
}

.extensions-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: var(--spacing-md);
}

.extension-card {
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius);
  padding: var(--spacing-lg);
  transition: border-color 0.2s, transform 0.2s;
}

.extension-card:hover {
  border-color: var(--color-primary);
  transform: translateY(-2px);
}

.extension-card-header {
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-md);
}

.extension-icon-img {
  width: 48px;
  height: 48px;
  border-radius: var(--border-radius);
  flex-shrink: 0;
  object-fit: contain;
}

.extension-icon-emoji {
  font-size: 2.5rem;
  flex-shrink: 0;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.extension-info {
  flex: 1;
  min-width: 0;
}

.extension-name {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0 0 var(--spacing-xs) 0;
}

.extension-name a {
  color: var(--color-text);
  text-decoration: none;
}

.extension-name a:hover {
  color: var(--color-primary);
}

.extension-type-badge {
  display: inline-block;
  padding: 2px 8px;
  background: var(--color-bg-secondary);
  border-radius: 12px;
  font-size: 0.75rem;
  color: var(--color-text-secondary);
}

.extension-description {
  color: var(--color-text-secondary);
  font-size: 0.875rem;
  margin-bottom: var(--spacing-md);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.extension-meta {
  display: flex;
  gap: var(--spacing-md);
  font-size: 0.75rem;
  color: var(--color-text-secondary);
}

.extension-stats {
  display: flex;
  gap: var(--spacing-md);
  align-items: center;
  margin-top: var(--spacing-sm);
  font-size: 0.8rem;
  color: var(--color-text-secondary);
}

.extension-stat {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.extension-stat svg {
  opacity: 0.7;
}

.star {
  font-size: 0.85rem;
  line-height: 1;
}

.star-filled {
  color: #f5a623;
}

.star-half {
  color: #f5a623;
  opacity: 0.6;
}

.star-empty {
  color: var(--color-text-secondary);
  opacity: 0.4;
}

.rating-count {
  font-size: 0.7rem;
  color: var(--color-text-secondary);
}

.extension-tags {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-xs);
  margin-top: var(--spacing-sm);
}

.extension-tag {
  padding: 2px 8px;
  background: var(--color-bg-secondary);
  border-radius: 12px;
  font-size: 0.7rem;
  color: var(--color-text-secondary);
}

.loading {
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--color-text-secondary);
}

.no-results {
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--color-text-secondary);
  grid-column: 1 / -1;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', async function() {
  const grid = document.getElementById('extensions-grid');
  const countEl = document.getElementById('extension-count');
  const typeFilter = document.getElementById('type-filter');
  const categoryFilter = document.getElementById('category-filter');
  const sortFilter = document.getElementById('sort-filter');
  
  let catalog = null;
  
  const typeIcons = {
    'agent': 'ðŸ¤–',
    'voice-agent': 'ðŸŽ™ï¸',
    'prompt': 'ðŸ“',
    'skill': 'âš¡',
    'mcp-server': 'ðŸ”Œ'
  };
  
  try {
    const response = await fetch('{{ "/catalog/catalog.json" | relative_url }}');
    catalog = await response.json();
    
    // Populate category filter
    catalog.categories.forEach(cat => {
      const option = document.createElement('option');
      option.value = cat;
      option.textContent = cat;
      categoryFilter.appendChild(option);
    });
    
    renderExtensions();
  } catch (error) {
    grid.innerHTML = '<div class="no-results">Failed to load extensions. Please try again later.</div>';
    console.error('Failed to load catalog:', error);
  }
  
  function renderStars(rating) {
    const r = rating || 0;
    let stars = '';
    for (let i = 1; i <= 5; i++) {
      if (r >= i) {
        stars += '<span class="star star-filled">â˜…</span>';
      } else if (r >= i - 0.5) {
        stars += '<span class="star star-half">â˜…</span>';
      } else {
        stars += '<span class="star star-empty">â˜†</span>';
      }
    }
    return stars;
  }
  
  function renderExtensions() {
    const typeValue = typeFilter.value;
    const categoryValue = categoryFilter.value;
    const sortValue = sortFilter.value;
    
    let filtered = catalog.extensions.filter(ext => {
      if (typeValue && ext.type !== typeValue) return false;
      if (categoryValue && !ext.categories.includes(categoryValue)) return false;
      return true;
    });
    
    // Sort
    filtered.sort((a, b) => {
      if (sortValue === 'name') return a.name.localeCompare(b.name);
      if (sortValue === 'newest') return new Date(b.publishedAt) - new Date(a.publishedAt);
      if (sortValue === 'downloads') return (b.downloads || 0) - (a.downloads || 0);
      if (sortValue === 'rating') return (b.rating || 0) - (a.rating || 0);
      return 0;
    });
    
    countEl.textContent = `${filtered.length} extension${filtered.length !== 1 ? 's' : ''} found`;
    
    if (filtered.length === 0) {
      grid.innerHTML = '<div class="no-results">No extensions match your filters.</div>';
      return;
    }
    
    const baseUrl = '{{ "/" | relative_url }}';
    
    function getExtensionUrl(ext) {
      const typeFolder = ext.type === 'mcp-server' ? 'mcp-servers' : ext.type + 's';
      return `${baseUrl}extensions/${typeFolder}/${ext.id}/`;
    }
    
    function getExtensionIcon(ext) {
      // Use local path for icons to work both on localhost and GitHub Pages
      const typeFolder = ext.type === 'mcp-server' ? 'mcp-servers' : ext.type + 's';
      const iconPath = `${baseUrl}extensions/${typeFolder}/${ext.id}/icon.svg`;
      if (ext.icon) {
        return `<img src="${iconPath}" alt="${ext.name}" class="extension-icon-img" onerror="this.parentElement.innerHTML='<span class=\\'extension-icon-emoji\\'>${typeIcons[ext.type] || 'ðŸ“¦'}</span>'">`;
      }
      if (ext.preview) {
        const previewPath = `${baseUrl}extensions/${typeFolder}/${ext.id}/preview.png`;
        return `<img src="${previewPath}" alt="${ext.name}" class="extension-icon-img">`;
      }
      return `<span class="extension-icon-emoji">${typeIcons[ext.type] || 'ðŸ“¦'}</span>`;
    }
    
    grid.innerHTML = filtered.map(ext => `
      <div class="extension-card">
        <div class="extension-card-header">
          ${getExtensionIcon(ext)}
          <div class="extension-info">
            <h3 class="extension-name">
              <a href="${getExtensionUrl(ext)}">${ext.name}</a>
            </h3>
            <span class="extension-type-badge">${ext.type}</span>
          </div>
        </div>
        <p class="extension-description">${ext.description}</p>
        <div class="extension-meta">
          <span>v${ext.version}</span>
          <span>by ${ext.author.name}</span>
        </div>
        <div class="extension-stats">
          <span class="extension-stat" title="Downloads">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            ${ext.downloads || 0}
          </span>
          <span class="extension-stat" title="${ext.rating ? ext.rating.toFixed(1) + ' average rating' : 'No ratings yet'}">
            ${renderStars(ext.rating)}
            <span class="rating-count">(${ext.ratingCount || 0})</span>
          </span>
        </div>
        <div class="extension-tags">
          ${ext.tags.slice(0, 3).map(tag => `<span class="extension-tag">${tag}</span>`).join('')}
        </div>
      </div>
    `).join('');
  }
  
  typeFilter.addEventListener('change', renderExtensions);
  categoryFilter.addEventListener('change', renderExtensions);
  sortFilter.addEventListener('change', renderExtensions);
});
</script>
